global:
  smtp_smarthost: 'localhost:587'

route:
  group_by: ['alertname', 'instance']
  group_wait: 5s
  group_interval: 5s
  receiver: 'telegram-default'
  
  routes:
    - match:
        alertname: NodeDown
      group_wait: 3s
      receiver: 'telegram-node-down'
      
    - match:
        alertname: RabbitMQDown
      group_wait: 3s
      receiver: 'telegram-rabbit-down'
      
    - match:
        alertname: PostgreSQLDown
      group_wait: 3s
      receiver: 'telegram-postgres-down'
      
    - match:
        alertname: HighMemoryUsage
      group_wait: 3s
      receiver: 'telegram-memory-critical'

    # Ğ’ĞĞ ĞĞ˜ĞĞ“Ğ˜ - Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
    - match:
        alertname: HighCPUUsage
      group_wait: 5s
      receiver: 'telegram-cpu-warning'
      
    - match:
        alertname: HighDiskUsage
      group_wait: 5s
      receiver: 'telegram-disk-warning'
      
    - match:
        alertname: RabbitMQHighMemory
      group_wait: 5s
      receiver: 'telegram-rabbit-warning'
      
    - match:
        alertname: RabbitMQQueueGrowth
      group_wait: 5s
      receiver: 'telegram-queue-warning'

    # ĞĞ‘Ğ©Ğ˜Ğ• ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜
    - match:
        severity: critical
      receiver: 'telegram-critical'
      
    - match:
        severity: warning
      receiver: 'telegram-warning'

receivers:
  # ğŸ–¥ï¸ ĞĞ›Ğ•Ğ Ğ¢Ğ« ĞĞ Ğ¡Ğ•Ğ Ğ’Ğ˜Ğ¡Ğ«
  - name: 'telegram-node-down'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ–¥ï¸ <b>SERVICE OFFLINE</b>

ğŸ”´ <b>Service:</b> {{ .GroupLabels.alertname }}
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}
ğŸ“… <b>Date:</b> {{ (index .Alerts 0).StartsAt.Format "02.01.2006" }}

ğŸš¨ <b>Impact:</b> Service monitoring stopped
ğŸ¯ <b>Action:</b> Check server connectivity'

      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
            chat_id: 667953047
            parse_mode: 'HTML'
            message: 'ğŸ–¥ï¸ <b>SERVICE OFFLINE</b>

  - name: 'telegram-rabbit-down'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ‡ <b>RABBITMQ DOWN</b>

ğŸ”´ <b>Service:</b> Message Broker
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸš¨ <b>Impact:</b> Message processing stopped
ğŸ¯ <b>Action:</b> Restart RabbitMQ service'

  - name: 'telegram-postgres-down'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ˜ <b>POSTGRESQL DOWN</b>

ğŸ”´ <b>Service:</b> Database
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸš¨ <b>Impact:</b> Database access lost
ğŸ¯ <b>Action:</b> Check PostgreSQL service'

  # ğŸ’¾ ĞĞ›Ğ•Ğ Ğ¢Ğ« ĞĞ Ğ Ğ•Ğ¡Ğ£Ğ Ğ¡Ğ«
  - name: 'telegram-memory-critical'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ’¾ <b>CRITICAL MEMORY USAGE</b>

ğŸŸ¡ <b>Resource:</b> System Memory
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
ğŸ“Š <b>Usage:</b> {{ (index .Alerts 0).Annotations.description | reReplaceAll ".*is ([0-9.]+).*" "$1" }}%
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸš¨ <b>Risk:</b> System instability
ğŸ¯ <b>Action:</b> Check memory usage and processes'

  - name: 'telegram-cpu-warning'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ”¥ <b>HIGH CPU USAGE</b>

ğŸŸ¡ <b>Resource:</b> Processor
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
ğŸ“Š <b>Usage:</b> {{ (index .Alerts 0).Annotations.description | reReplaceAll ".*is ([0-9.]+).*" "$1" }}%
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸ’¡ <b>Recommendation:</b> Optimize workloads'

  - name: 'telegram-disk-warning'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ’½ <b>HIGH DISK USAGE</b>

ğŸŸ¡ <b>Resource:</b> Storage
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
ğŸ“Š <b>Usage:</b> {{ (index .Alerts 0).Annotations.description | reReplaceAll ".*is ([0-9.]+).*" "$1" }}%
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸ’¡ <b>Recommendation:</b> Clean up disk space'

  # ğŸ‡ RABBITMQ WARNINGS
  - name: 'telegram-rabbit-warning'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ“ˆ <b>RABBITMQ MEMORY WARNING</b>

ğŸŸ¡ <b>Service:</b> Message Broker
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
ğŸ“Š <b>Memory Usage:</b> {{ (index .Alerts 0).Annotations.description | reReplaceAll ".*is ([0-9.]+).*" "$1" }}%
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸ’¡ <b>Note:</b> High memory usage may cause message delays'

  - name: 'telegram-queue-warning'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ“Š <b>QUEUE GROWTH DETECTED</b>

ğŸŸ¡ <b>Service:</b> RabbitMQ Queue
ğŸ“ <b>Queue:</b> {{ .GroupLabels.queue }}
ğŸ“ˆ <b>Growth Rate:</b> {{ (index .Alerts 0).Annotations.description | reReplaceAll ".*at ([0-9.]+).*" "$1" }} msg/sec
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸ’¡ <b>Note:</b> Queue is growing faster than messages are processed'

  # ğŸ”§ ĞĞ‘Ğ©Ğ˜Ğ• Ğ Ğ•Ğ¡Ğ˜Ğ’Ğ•Ğ Ğ« (ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ¿Ğ¾Ğ¿Ğ°Ğ»Ğ¸ Ğ² ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ)
  - name: 'telegram-critical'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸš¨ <b>CRITICAL ALERT</b>

ğŸ”´ <b>Alert:</b> {{ .GroupLabels.alertname }}
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

{{ (index .Alerts 0).Annotations.summary }}
ğŸ¯ <b>Action Required:</b> Immediate investigation'

  - name: 'telegram-warning'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'âš ï¸ <b>WARNING ALERT</b>

ğŸŸ¡ <b>Alert:</b> {{ .GroupLabels.alertname }}
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

{{ (index .Alerts 0).Annotations.summary }}
ğŸ’¡ <b>Monitor:</b> Keep watching the situation'

  - name: 'telegram-default'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ”” <b>ALERT NOTIFICATION</b>

ğŸ“¢ <b>Alert:</b> {{ .GroupLabels.alertname }}
ğŸ“ <b>Instance:</b> <code>{{ .GroupLabels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

{{ (index .Alerts 0).Annotations.summary }}'
