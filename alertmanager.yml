global:
  smtp_smarthost: 'localhost:587'

route:
  group_by: ['alertname', 'instance', 'service']
  group_wait: 1s
  group_interval: 1s
  repeat_interval: 2m
  receiver: 'telegram-service-down'
  
  routes:
    # Ğ­ĞšĞ¡ĞŸĞĞ Ğ¢Ğ•Ğ Ğ« DOWN
    - match:
        alertname: NodeExporterDown
      receiver: 'telegram-exporter-down'
      group_wait: 0s
      repeat_interval: 1m
      
    - match:
        alertname: CadvisorDown
      receiver: 'telegram-exporter-down'
      group_wait: 0s
      repeat_interval: 1m
      
    - match:
        alertname: PostgresExporterDown
      receiver: 'telegram-exporter-down'
      group_wait: 0s
      repeat_interval: 1m
      
    - match:
        alertname: RabbitMQExporterDown
      receiver: 'telegram-exporter-down'
      group_wait: 0s
      repeat_interval: 1m

    # Ğ¡Ğ•Ğ Ğ’Ğ˜Ğ¡Ğ« DOWN
    - match:
        alertname: RabbitMQServiceDown
      receiver: 'telegram-service-down'
      group_wait: 0s
      repeat_interval: 1m
      
    - match:
        alertname: PostgreSQLServiceDown
      receiver: 'telegram-service-down'
      group_wait: 0s
      repeat_interval: 1m

    # Ğ Ğ•Ğ¡Ğ£Ğ Ğ¡Ğ«
    - match:
        alertname: HighCPUUsage
      receiver: 'telegram-resource-warning'
      group_wait: 3s
      repeat_interval: 5m
      
    - match:
        alertname: HighMemoryUsage
      receiver: 'telegram-resource-critical'
      group_wait: 0s
      repeat_interval: 2m
      
    - match:
        alertname: HighDiskUsage
      receiver: 'telegram-resource-warning'
      group_wait: 3s
      repeat_interval: 5m

receivers:
  # ğŸ“¡ Ğ­ĞšĞ¡ĞŸĞĞ Ğ¢Ğ•Ğ Ğ« DOWN
  - name: 'telegram-exporter-down'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ“¡ <b>MONITORING EXPORTER DOWN</b>

ğŸ”´ <b>Service:</b> {{ (index .Alerts 0).Labels.service }}
ğŸ“ <b>Instance:</b> <code>{{ (index .Alerts 0).Labels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸ“ <b>Issue:</b> {{ (index .Alerts 0).Annotations.summary }}
ğŸš¨ <b>Impact:</b> {{ (index .Alerts 0).Annotations.description }}
ğŸ¯ <b>Action:</b> Restart the exporter service'

  # ğŸ–¥ï¸ Ğ¡Ğ•Ğ Ğ’Ğ˜Ğ¡Ğ« DOWN
  - name: 'telegram-service-down'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ–¥ï¸ <b>SERVICE DOWN</b>

ğŸ”´ <b>Service:</b> {{ (index .Alerts 0).Labels.service | title }}
ğŸ“ <b>Instance:</b> <code>{{ (index .Alerts 0).Labels.instance }}</code>
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸ“ <b>Issue:</b> {{ (index .Alerts 0).Annotations.summary }}
ğŸš¨ <b>Impact:</b> {{ (index .Alerts 0).Annotations.description }}
ğŸ¯ <b>Action:</b> Check and restart the service'

  # ğŸ’¾ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ• Ğ Ğ•Ğ¡Ğ£Ğ Ğ¡Ğ«
  - name: 'telegram-resource-critical'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'ğŸ’¥ <b>CRITICAL RESOURCE USAGE</b>

ğŸ”´ <b>Resource:</b> {{ (index .Alerts 0).Annotations.summary }}
ğŸ“ <b>Instance:</b> <code>{{ (index .Alerts 0).Labels.instance }}</code>
ğŸ“Š <b>Usage:</b> {{ (index .Alerts 0).Annotations.description | reReplaceAll ".*is ([0-9.]+).*" "$1" }}%
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸš¨ <b>Risk:</b> System instability possible
ğŸ¯ <b>Action:</b> Immediate investigation required'

  # âš ï¸ WARNING Ğ Ğ•Ğ¡Ğ£Ğ Ğ¡Ğ«
  - name: 'telegram-resource-warning'
    telegram_configs:
      - bot_token: '8122760259:AAGmxaNBuRBa3Czomez_hTd1BI5G37M2pN8'
        chat_id: 1061129761
        parse_mode: 'HTML'
        message: 'âš ï¸ <b>RESOURCE WARNING</b>

ğŸŸ¡ <b>Resource:</b> {{ (index .Alerts 0).Annotations.summary }}
ğŸ“ <b>Instance:</b> <code>{{ (index .Alerts 0).Labels.instance }}</code>
ğŸ“Š <b>Usage:</b> {{ (index .Alerts 0).Annotations.description | reReplaceAll ".*is ([0-9.]+).*" "$1" }}%
â° <b>Time:</b> {{ (index .Alerts 0).StartsAt.Format "15:04:05" }}

ğŸ’¡ <b>Note:</b> Monitor the situation'
